** this code may need some refactor for readability and i will do that in future commits **